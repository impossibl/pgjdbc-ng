dist: xenial
language: java
jdk:
  - openjdk10
matrix:
  include:
    - addons:
        postgresql: 9.4
    - addons:
        postgresql: 9.5
    - addons:
        postgresql: 9.6
    - addons:
        postgresql: 10
before_install:
  - sudo -u postgres psql -c "SHOW server_version;"
  - sudo -u postgres psql -c "CREATE USER pgjdbc WITH PASSWORD 'test';"
  - sudo -u postgres psql -c 'CREATE DATABASE test WITH OWNER pgjdbc;'
  - sudo -u postgres psql test -c 'CREATE EXTENSION hstore; CREATE EXTENSION citext;'
script: mvn -e test
after_failure:
  - ./.travis/print_surefire_reports
after_success:
  - "test $TRAVIS_PULL_REQUEST == 'false' && test $TRAVIS_BRANCH == 'develop' && test $TRAVIS_JDK_VERSION == 'oraclejdk8' && test $PGVERSION == '9.5' && ./.travis/travis-maven-deploy"
cache:
  directories:
    - '$HOME/.m2/repository'
